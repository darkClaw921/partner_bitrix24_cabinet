<div align="center">

# Bitrix24 Lead Transfer

### –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ –ª–∏–¥–æ–≤ –≤ Bitrix24

<p align="center">
  <img src="./logo.svg" alt="Bitrix24 Lead Transfer Logo" width="1200" />
</p>

<p align="center">
  <a href="#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏">üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</a> ¬∑ 
  <a href="#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫">üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞</a> ¬∑ 
  <a href="architecture.md">üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a> ¬∑ 
  <a href="#api-endpoints">üîå API</a>
</p>

</div>

<br />

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ workflow (–∫–∞–∂–¥—ã–π workflow = –æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–∏–¥–æ–≤ –≤—Ä—É—á–Ω—É—é, —á–µ—Ä–µ–∑ API –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫—É CSV —Ñ–∞–π–ª–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏–¥–æ–≤ –≤ Bitrix24 –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç Bitrix24 –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ª–∏–¥–æ–≤
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ workflow
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–∞–±–ª–∏—Ü —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π

## –ü—Ä–∏–º–µ—Ä workflow
<p align="center">
  <img src="./workflow.png" alt="Bitrix24 Lead Transfer Workflow"  />
</p>

## –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫ workflow
<p align="center">
  <img src="./setting_workflow.png" alt="Bitrix24 Lead Transfer Workflow Settings" width="600" />
</p>

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- FastAPI
- SQLAlchemy
- SQLite (–¥–ª—è workflow –ë–î)
- Pydantic
- bcrypt
- httpx

### Frontend
- React 19
- TypeScript
- Vite
- Tailwind CSS
- Zustand
- React Router
- Axios

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
cp .env.example .env
```


2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
docker-compose up -d --build
```

3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ:
   - Frontend: http://localhost:3012

4. **–í–∞–∂–Ω–æ**: –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:
   - `main.db` - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, workflow)
   - `workflows/` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ workflow
   - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

5. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
docker-compose down
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Ñ–∞–π–ª—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ü—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è volumes.

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.12+
- Node.js 20+ (LTS)
- uv (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python)

### Backend

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
uv sync
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
cp .env.example .env
```



Backend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:7860

### Frontend

```bash
cd src/frontend && npm install && npm run dev
```
### Backend
```bash
uv run uvicorn src.backend.main:app --reload --port 7860
```

Frontend –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:3000

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø—É–±–ª–∏—á–Ω—ã–π API endpoint –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ –ø–æ—Ä—Ç—É 3000 (–≤ dev-—Ä–µ–∂–∏–º–µ) –∏–ª–∏ 3012 (–≤ production —á–µ—Ä–µ–∑ Docker).

## –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ Python:
```bash
uv run create_admin.py
```

2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É —Å —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

3. –°–æ–∑–¥–∞–π—Ç–µ workflow —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Bitrix24:
   - URL –ø–æ—Ä—Ç–∞–ª–∞ Bitrix24
   - Webhook token –¥–ª—è REST API

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook –≤ Bitrix24:
   - URL: `http://your-server/api/v1/webhook/{workflow_id}`
   - –°–æ–±—ã—Ç–∏—è: `ONCRMLEADUPDATE`, `ONCRMLEADADD`, `ONCRMDEALUPDATE`, `ONCRMDEALADD`

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏–¥–∞

1. –í—ã–±–µ—Ä–∏—Ç–µ workflow
2. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –ª–∏–¥" –∏–ª–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å CSV"
3. –õ–∏–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç—Å—è –≤ Bitrix24

### –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞

CSV —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
- `phone` (–∏–ª–∏ `—Ç–µ–ª–µ—Ñ–æ–Ω`)
- `name` (–∏–ª–∏ `–∏–º—è`)

–ü—Ä–∏–º–µ—Ä:
```csv
phone,name
+79991234567,–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
+79997654321,–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤
```

### API Endpoints

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `POST /api/v1/auth/login` - –í—Ö–æ–¥
- `POST /api/v1/auth/logout` - –í—ã—Ö–æ–¥
- `GET /api/v1/auth/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

#### Workflows
- `GET /api/v1/workflows` - –°–ø–∏—Å–æ–∫ workflow
- `POST /api/v1/workflows` - –°–æ–∑–¥–∞—Ç—å workflow
- `GET /api/v1/workflows/{id}` - –ü–æ–ª—É—á–∏—Ç—å workflow
- `DELETE /api/v1/workflows/{id}` - –£–¥–∞–ª–∏—Ç—å workflow

#### Leads
- `GET /api/v1/workflows/{id}/leads` - –°–ø–∏—Å–æ–∫ –ª–∏–¥–æ–≤
- `POST /api/v1/workflows/{id}/leads` - –°–æ–∑–¥–∞—Ç—å –ª–∏–¥
- `POST /api/v1/workflows/{id}/leads/upload` - –ó–∞–≥—Ä—É–∑–∏—Ç—å CSV

#### Webhook
- `POST /api/v1/webhook` - Webhook –æ—Ç Bitrix24 (–µ–¥–∏–Ω—ã–π endpoint –¥–ª—è –≤—Å–µ—Ö workflow)

#### –ü—É–±–ª–∏—á–Ω—ã–π API
- `POST /api/public/workflows/{token}/leads` - –°–æ–∑–¥–∞—Ç—å –ª–∏–¥ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- `GET /api/public/workflows/{token}/leads` - –°–æ–∑–¥–∞—Ç—å –ª–∏–¥ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API —Å query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü—É–±–ª–∏—á–Ω—ã–π API –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞ –ø–æ—Ä—Ç—É 3012 (–≤ production) –∏–ª–∏ 3000 (–≤ dev-—Ä–µ–∂–∏–º–µ). URL –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ API —Ç–æ–∫–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö workflow.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–º. –≤ [architecture.md](architecture.md)




## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

